<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI支援システム - Pro版お申込みページ</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* ================================================
       コンテナ全体
       ================================================ */
    .signup-container {
      max-width: 550px;
      margin: 100px auto;
      padding: 30px;
      background-color: #252C48;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    .signup-container img {
      display: block;
      margin: 0 auto 20px;
      max-width: 100%;
      height: auto;
    }
    .signup-container h1 {
      text-align: center;
      margin-bottom: 16px;
      font-size: 2rem;
      color: #FFFFFF;
      line-height: 1.5;
      letter-spacing: 2px;
    }
    .signup-container p {
      text-align: center;
      margin-bottom: 24px;
      font-size: 1rem;
      color: #CCCCCC;
      line-height: 1.4;
    }
    .form-row {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    .form-row label {
      flex: 0 0 120px;
      white-space: nowrap;
      color: #FFFFFF;
      text-align: right;
      margin-right: 10px;
      font-size: 1rem;
    }
    .form-row input,
    .form-row select {
      flex: 1;
      padding: 12px;
      border: 1px solid #444;
      border-radius: 4px;
      font-size: 1rem;
      background-color: #1A1B2E;
      color: #FFFFFF;
      box-sizing: border-box;
    }
    .form-row select {
      appearance: none;
      background-image: url('data:image/svg+xml;charset=UTF-8,\
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="%23FFFFFF" viewBox="0 0 16 16">\
<path d="M4.646 6.646a.5.5 0 0 1 .708 0L8 9.293l2.646-2.647a.5.5 0 0 1 .708.708L8 10.707L4.646 7.354a.5.5 0 0 1 0-.708z"/>\
</svg>');
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 12px;
    }
    .form-row input:focus,
    .form-row select:focus {
      outline: none;
      border-color: #7B5DF5;
      box-shadow: 0 0 4px rgba(123, 93, 245, 0.7);
    }
    .form-row label[for="signup-email"] {
      margin-left: -8px;
    }
    .button-container {
      text-align: center;
      margin-top: 50px;
    }
    .analyze-button {
      display: inline-block;
      padding: 15px 40px;
      background-color: #FF8C00;
      border: none;
      border-radius: 4px;
      color: #FFFFFF;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.3s ease;
      text-decoration: none;
    }
    .analyze-button:hover {
      background-color: #F57C00;
      transform: translateY(-2px);
    }
    /* 利用規約スタイル */
    .tos {
      font-size: 0.9rem;
      color: #CCCCCC;
      margin-top: 0px;
      line-height: 1.4;
      text-align: center;
    }
    .tos a {
      color: #FF8C00;
      text-decoration: underline;
    }
  </style>
</head>
  
<body>
  <div class="signup-container">
    <img src="https://cdn.glitch.global/d6b52f0f-967d-4d53-8d7f-3cfb840bae62/AI%20Supprot%20System%20(1000%20x%20200%20px).png?v=1740035748637" alt="AI Support System Logo" />
    <h1>AI支援システム<br/>Pro版お申込みページ</h1>
    <p>下記のフォームにご入力の上、決済へお進みください。</p>
    <form id="pro-signup-form">
      <div class="form-row">
        <label for="signup-name">お名前：</label>
        <input type="text" id="signup-name" name="name" required placeholder="例：山田太郎" />
      </div>
      <div class="form-row">
        <label for="signup-phone">電話番号：</label>
        <input type="tel" id="signup-phone" name="phone" required placeholder="例：09012345678" />
      </div>
      <div class="form-row">
        <label for="signup-email">メールアドレス：</label>
        <input type="email" id="signup-email" name="email" required placeholder="例：taro@example.com" />
      </div>
      <div class="form-row">
        <label for="signup-plan">プラン：</label>
        <select id="signup-plan" name="plan" required>
          <option value="" disabled selected>選択してください</option>
          <option value="monthly">月額プラン（¥5,500/月）</option>
          <option value="yearly">年間プラン（¥55,000/年）</option>
        </select>
      </div>
      <div class="button-container">
        <button type="button" id="pro-checkout-btn" class="analyze-button">
          決済へ進む
        </button>
      </div>
    </form>
    <p class="tos">
      AI支援システムの利用については
      <a href="https://jb-revo.com/contents/wp-content/uploads/2025/05/AI-support-system-terms-of-use.pdf" target="_blank" rel="noopener noreferrer">
        利用規約
      </a>
      が適用されます。<br>
      必ず事前に一読をお願いします。
    </p>    
  </div>

  
  <!-- Univapay ウィジェット読み込み -->
  <script src="https://widget.univapay.com/client/checkout.js"></script>
  
  <script>
    // 定数定義
    // テスト決済↓
    //const APP_ID = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcHBfdG9rZW4iLCJpYXQiOjE3NDg4NTE5NDUsIm1lcmNoYW50X2lkIjoiMTFlZmNmNmMtMWE4NC1hZTZjLTkzNzItMzNjYWI3NTFmNzUwIiwic3RvcmVfaWQiOiIxMWVmY2Y2Yy0xYjU1LWQ5NzQtODY0YS1hZjY1MGIyZmQ5YTIiLCJkb21haW5zIjpbImFpLXN1cHBvcnQtc3lzdGVtLWJldGEyLmdsaXRjaC5tZSJdLCJtb2RlIjoidGVzdCIsImNyZWF0b3JfaWQiOiIxMWVmY2Y2Yy0xYTg0LWFlNmMtOTM3Mi0zM2NhYjc1MWY3NTAiLCJ2ZXJzaW9uIjoxLCJqdGkiOiIxMWYwM2Y4OS01MTgxLWRjZWQtYWE4NS1mZDcyYmEzNjNjNWYifQ.LHL_Fx-4hcquhI6QlFmdY8E8b5ffOiWsiTf6Haq-CJI";
    // 本番決済↓
    const APP_ID ="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcHBfdG9rZW4iLCJpYXQiOjE3NDg4NTIxMzYsIm1lcmNoYW50X2lkIjoiMTFlZmNmNmMtMWE4NC1hZTZjLTkzNzItMzNjYWI3NTFmNzUwIiwic3RvcmVfaWQiOiIxMWVmY2Y2Yy0xYjU1LWQ5NzQtODY0YS1hZjY1MGIyZmQ5YTIiLCJkb21haW5zIjpbImFpLXN1cHBvcnQtc3lzdGVtLWJldGEyLmdsaXRjaC5tZSJdLCJtb2RlIjoibGl2ZSIsImNyZWF0b3JfaWQiOiIxMWVmY2Y2Yy0xYTg0LWFlNmMtOTM3Mi0zM2NhYjc1MWY3NTAiLCJ2ZXJzaW9uIjoxLCJqdGkiOiIxMWYwM2Y4OS1jMzM5LTMxYjItYjUwYS1lMWY1NjE2ZTJjZDUifQ.5mRp2j_eAka5ZIDt_meRN6TDy7Rya0Ttnx2_NulV8Gg"; 
    const REDIRECT_URL = "https://ai-support-system-beta2.glitch.me/pro-completion.html";

    document.getElementById("pro-checkout-btn").addEventListener("click", () => {
      // 1) フォーム値取得
      const name  = document.getElementById("signup-name").value.trim();
      const phone = document.getElementById("signup-phone").value.trim();
      const email = document.getElementById("signup-email").value.trim();
      const plan  = document.getElementById("signup-plan").value;
      if (!name || !phone || !email || !plan) {
        return alert("全ての項目を正しく入力してください。");
      }

      // 2) プランごとの金額・周期を設定
      let amount, subscriptionPeriod;
      if (plan === "monthly") {
        amount             = 5500;   // ¥5,500/月
        subscriptionPeriod = "P1M";  // ISO8601：1ヶ月ごと
        var productName    = '【月額プラン】パートナービジネス特化型-AI支援システム-'; // 商品名
      
      } else {
        amount             = 55000;  // ¥55,000／年
        subscriptionPeriod = "P12M"; // ISO8601：12ヶ月ごと
        var productName    = '【年間プラン】パートナービジネス特化型-AI支援システム-'; // 商品名        
      }

      // 3) ウィジェット設定
      const config = {
        appId:               APP_ID,
        checkout:            "payment",
        tokenType:           "subscription",
        amount:              amount,
        currency:            "jpy",
        subscriptionPeriod:  subscriptionPeriod,
        cvvAuthorize:        true,
        autoRedirect:        true,
        showRedirectMetadata:true,
        successRedirectUrl:  REDIRECT_URL,
        processingRedirectUrl: REDIRECT_URL,
        // コールバック内で自前リダイレクトする場合はこう書く
        onSuccess: () => {
          console.log("決済成功：リダイレクトします");
          window.location.href = REDIRECT_URL;
        },
        onProcessing: () => {
          console.log("決済処理中：リダイレクトします");
          window.location.href = REDIRECT_URL;
        },
        debug:               true,
        onError: err => {
          console.error("[Univapay Widget Error]", err);
          alert("決済中にエラーが発生しました。\n詳しくはコンソールをご確認ください。");
        }
      };

      console.log("[DEBUG] Univapay config:", config);

      // 4) ウィジェット呼び出し
      const checkout = UnivapayCheckout.create(config);

      // ⇒「名前・メール・プラン」を localStorage に保存
      localStorage.setItem(
        'subscriptionInfo',
        JSON.stringify({ name, email, plan, productName  })
      );
      
            
      // ポップアップを開く
      checkout.open({
        metadata: {
          customerName: name,
          email:        email,
          phone:        phone,
          productName:  productName
        }
      });    
    });
  </script>
</body>
</html>